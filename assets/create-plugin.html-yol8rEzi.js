import{_ as h,e as d,f as e,g as a,h as s,i as t,j as l,r as p,o}from"./app-yjG2kzMn.js";const r={},k={class:"hint-container caution"};function c(g,i){const n=p("RouteLink");return o(),d("div",null,[i[10]||(i[10]=e(`<h1 id="插件编写准备" tabindex="-1"><a class="header-anchor" href="#插件编写准备"><span>插件编写准备</span></a></h1><p>在正式编写插件之前，我们需要先了解一下插件的概念。</p><h2 id="插件结构" tabindex="-1"><a class="header-anchor" href="#插件结构"><span>插件结构</span></a></h2><p>在 NoneBot 中，插件即是 Python 的一个<a href="https://docs.python.org/zh-cn/3/glossary.html#term-module" target="_blank" rel="noopener noreferrer">模块（module）</a>。NoneBot 会在导入时对这些模块做一些特殊的处理使得他们成为一个插件。插件间应尽量减少耦合，可以进行有限制的相互调用，NoneBot 能够正确解析插件间的依赖关系。</p><h3 id="单文件插件" tabindex="-1"><a class="header-anchor" href="#单文件插件"><span>单文件插件</span></a></h3><p>一个普通的 <code>.py</code> 文件即可以作为一个插件，例如创建一个 <code>foo.py</code> 文件：</p><div class="language-tree line-numbers-mode" data-highlighter="shiki" data-ext="tree" data-title="tree" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>📂 plugins</span></span>
<span class="line"><span>└── 📜 foo.py</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>这个时候模块 <code>foo</code> 已经可以被称为一个插件了，尽管它还什么都没做。</p><h3 id="包插件" tabindex="-1"><a class="header-anchor" href="#包插件"><span>包插件</span></a></h3><p>一个包含 <code>__init__.py</code> 的文件夹即是一个常规 Python <a href="https://docs.python.org/zh-cn/3/glossary.html#term-regular-package" target="_blank" rel="noopener noreferrer">包 <code>package</code></a>，例如创建一个 <code>foo</code> 文件夹：</p><div class="language-tree line-numbers-mode" data-highlighter="shiki" data-ext="tree" data-title="tree" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>📂 plugins</span></span>
<span class="line"><span>└── 📂 foo</span></span>
<span class="line"><span>    └── 📜 __init__.py</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个时候包 <code>foo</code> 同样是一个合法的插件，插件内容可以在 <code>__init__.py</code> 文件中编写。</p><h2 id="创建插件" tabindex="-1"><a class="header-anchor" href="#创建插件"><span>创建插件</span></a></h2><div class="hint-container caution"><p class="hint-container-title">注意</p><p>如果在之前的<a href="../quick-start.mdx">快速上手</a>章节中已经使用 <code>bootstrap</code> 模板创建了项目，那么你需要做出如下修改：</p><ol><li><p>在项目目录中创建一个两层文件夹 <code>awesome_bot/plugins</code></p><div class="language-tree line-numbers-mode" data-highlighter="shiki" data-ext="tree" data-title="tree" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>📦 awesome-bot</span></span>
<span class="line"><span>├── 📂 awesome_bot</span></span>
<span class="line"><span>│   └── 📂 plugins</span></span>
<span class="line"><span>├── 📜 pyproject.toml</span></span>
<span class="line"><span>└── 📜 README.md</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>修改 <code>pyproject.toml</code> 文件中的 <code>nonebot</code> 配置项，在 <code>plugin_dirs</code> 中添加 <code>awesome_bot/plugins</code></p><div class="language-toml line-numbers-mode" data-highlighter="shiki" data-ext="toml" data-title="toml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tool</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nonebot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">plugin_dirs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;awesome_bot/plugins&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></div>`,14)),a("div",k,[i[3]||(i[3]=a("p",{class:"hint-container-title"},"注意",-1)),a("p",null,[i[1]||(i[1]=s("如果在之前的")),t(n,{to:"/tutorial/application.html"},{default:l(()=>i[0]||(i[0]=[s("创建项目")])),_:1}),i[2]||(i[2]=s("章节中手动创建了相关文件，那么你需要做出如下修改："))]),i[4]||(i[4]=e(`<ol><li><p>在项目目录中创建一个两层文件夹 <code>awesome_bot/plugins</code></p><div class="language-tree line-numbers-mode" data-highlighter="shiki" data-ext="tree" data-title="tree" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>📦 awesome-bot</span></span>
<span class="line"><span>├── 📂 awesome_bot</span></span>
<span class="line"><span>│   └── 📂 plugins</span></span>
<span class="line"><span>└── 📜 bot.py</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>修改 <code>bot.py</code> 文件中的加载插件部分，取消注释或者添加如下代码</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在这里加载插件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_builtin_plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;echo&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 内置插件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;awesome_bot/plugins&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 本地插件</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol>`,1))]),i[11]||(i[11]=e(`<p>创建插件可以通过 <code>nb-cli</code> 命令从完整模板创建，也可以手动新建空白文件。通过以下命令创建一个名为 <code>weather</code> 的插件：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> plugin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[?] 插件名称: weather</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[?] 使用嵌套插件? (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">y/N</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) N</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[?] 输出目录: awesome_bot/plugins</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>nb-cli</code> 会在 <code>awesome_bot/plugins</code> 目录下创建一个名为 <code>weather</code> 的文件夹，其中包含的文件将在稍后章节中用到。</p><div class="language-tree line-numbers-mode" data-highlighter="shiki" data-ext="tree" data-title="tree" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>📦 awesome-bot</span></span>
<span class="line"><span>├── 📂 awesome_bot</span></span>
<span class="line"><span>│   └── 📂 plugins</span></span>
<span class="line"><span>|       └── 📂 foo</span></span>
<span class="line"><span>|           ├── 📜 __init__.py</span></span>
<span class="line"><span>|           └── 📜 config.py</span></span>
<span class="line"><span>├── 📜 pyproject.toml</span></span>
<span class="line"><span>└── 📜 README.md</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="加载插件" tabindex="-1"><a class="header-anchor" href="#加载插件"><span>加载插件</span></a></h2><div class="hint-container caution"><p class="hint-container-title">警告</p><p>请勿在插件被加载前 <code>import</code> 插件模块，这会导致 NoneBot 无法将其转换为插件而出现意料之外的情况。</p></div><p>加载插件是在机器人入口文件中完成的，需要在框架初始化之后，运行之前进行。</p><p>请注意，加载的插件模块名称（插件文件名或文件夹名）<strong>不能相同</strong>，且每一个插件<strong>只能被加载一次</strong>，重复加载将会导致异常。</p><p>如果你使用 <code>nb-cli</code> 管理插件，那么你可以跳过这一节，<code>nb-cli</code> 将会自动处理加载。</p><p>如果你<strong>使用自定义的入口文件</strong> <code>bot.py</code>，那么你需要在 <code>bot.py</code> 中加载插件。</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nonebot</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">init</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 加载插件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>加载插件的方式有多种，但在底层的加载逻辑是一致的。以下是为加载插件提供的几种方式：</p><h3 id="load-plugin" tabindex="-1"><a class="header-anchor" href="#load-plugin"><span><code>load_plugin</code></span></a></h3><p>通过点分割模块名称或使用 <a href="https://docs.python.org/zh-cn/3/library/pathlib.html" target="_blank" rel="noopener noreferrer"><code>pathlib</code></a> 的 <code>Path</code> 对象来加载插件。通常用于加载第三方插件或者项目插件。例如：</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pathlib </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Path</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_plugin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path.to.your.plugin&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 加载第三方插件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_plugin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;./path/to/your/plugin.py&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 加载项目插件</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container caution"><p class="hint-container-title">注意</p><p>请注意，本地插件的路径应该为相对机器人 <strong>入口文件（通常为 bot.py）</strong> 可导入的，例如在项目 <code>plugins</code> 目录下。</p></div><h3 id="load-plugins" tabindex="-1"><a class="header-anchor" href="#load-plugins"><span><code>load_plugins</code></span></a></h3><p>加载传入插件目录中的所有插件，通常用于加载一系列本地编写的项目插件。例如：</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;src/plugins&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path/to/your/plugins&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container caution"><p class="hint-container-title">注意</p><p>请注意，插件目录应该为相对机器人 <strong>入口文件（通常为 bot.py）</strong> 可导入的，例如在项目 <code>plugins</code> 目录下。</p></div><h3 id="load-all-plugins" tabindex="-1"><a class="header-anchor" href="#load-all-plugins"><span><code>load_all_plugins</code></span></a></h3><p>这种加载方式是以上两种方式的混合，加载所有传入的插件模块名称，以及所有给定目录下的插件。例如：</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_all_plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path.to.your.plugin&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path/to/your/plugins&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="load-from-json" tabindex="-1"><a class="header-anchor" href="#load-from-json"><span><code>load_from_json</code></span></a></h3><p>通过 JSON 文件加载插件，是 <a href="#load_all_plugins"><code>load_all_plugins</code></a> 的 JSON 变种。通过读取 JSON 文件中的 <code>plugins</code> 字段和 <code>plugin_dirs</code> 字段进行加载。例如：</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;plugins&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path.to.your.plugin&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;plugin_dirs&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path/to/your/plugins&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_from_json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;plugin_config.json&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;utf-8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果 JSON 配置文件中的字段无法满足你的需求，可以使用 <a href="#load_all_plugins"><code>load_all_plugins</code></a> 方法自行读取配置来加载插件。</p></div><h3 id="load-from-toml" tabindex="-1"><a class="header-anchor" href="#load-from-toml"><span><code>load_from_toml</code></span></a></h3><p>通过 TOML 文件加载插件，是 <a href="#load_all_plugins"><code>load_all_plugins</code></a> 的 TOML 变种。通过读取 TOML 文件中的 <code>[tool.nonebot]</code> Table 中的 <code>plugins</code> 和 <code>plugin_dirs</code> Array 进行加载。例如：</p><div class="language-toml line-numbers-mode" data-highlighter="shiki" data-ext="toml" data-title="toml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tool</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nonebot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path.to.your.plugin&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">plugin_dirs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path/to/your/plugins&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_from_toml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;plugin_config.toml&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;utf-8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果 TOML 配置文件中的字段无法满足你的需求，可以使用 <a href="#load_all_plugins"><code>load_all_plugins</code></a> 方法自行读取配置来加载插件。</p></div><h3 id="load-builtin-plugin" tabindex="-1"><a class="header-anchor" href="#load-builtin-plugin"><span><code>load_builtin_plugin</code></span></a></h3><p>加载一个内置插件，传入的插件名必须为 NoneBot 内置插件。该方法是 <a href="#load_plugin"><code>load_plugin</code></a> 的封装。例如：</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_builtin_plugin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;echo&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="load-builtin-plugins" tabindex="-1"><a class="header-anchor" href="#load-builtin-plugins"><span><code>load_builtin_plugins</code></span></a></h3><p>加载传入插件列表中的所有内置插件。例如：</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nonebot.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_builtin_plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;echo&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;single_session&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="其他加载方式" tabindex="-1"><a class="header-anchor" href="#其他加载方式"><span>其他加载方式</span></a></h3>`,40)),a("p",null,[i[7]||(i[7]=s("有关其他插件加载的方式，可参考")),t(n,{to:"/advanced/requiring.html"},{default:l(()=>i[5]||(i[5]=[s("跨插件访问")])),_:1}),i[8]||(i[8]=s("和")),t(n,{to:"/advanced/plugin-nesting.html"},{default:l(()=>i[6]||(i[6]=[s("嵌套插件")])),_:1}),i[9]||(i[9]=s("。"))])])}const b=h(r,[["render",c],["__file","create-plugin.html.vue"]]),A=JSON.parse('{"path":"/tutorial/create-plugin.html","title":"插件编写准备","lang":"zh-CN","frontmatter":{"sidebar_position":3,"description":"创建并加载自定义插件","options":{"menu":[{"category":"tutorial","weight":50}]},"head":[["meta",{"property":"og:url","content":"https://LincDocs.github.io/nonebot2/tutorial/create-plugin.html"}],["meta",{"property":"og:site_name","content":"nonebot2"}],["meta",{"property":"og:title","content":"插件编写准备"}],["meta",{"property":"og:description","content":"创建并加载自定义插件"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"插件编写准备\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LincDocs\\",\\"url\\":\\"https://github.com/LincDocs/nonebot2/\\"}]}"]]},"git":{},"readingTime":{"minutes":4.48,"words":1344},"filePathRelative":"tutorial/create-plugin.md","excerpt":"\\n<p>在正式编写插件之前，我们需要先了解一下插件的概念。</p>\\n<h2>插件结构</h2>\\n<p>在 NoneBot 中，插件即是 Python 的一个<a href=\\"https://docs.python.org/zh-cn/3/glossary.html#term-module\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">模块（module）</a>。NoneBot 会在导入时对这些模块做一些特殊的处理使得他们成为一个插件。插件间应尽量减少耦合，可以进行有限制的相互调用，NoneBot 能够正确解析插件间的依赖关系。</p>\\n<h3>单文件插件</h3>","bioChainData":{"outlink":[{"title":"application","link":"tutorial/application.html"},{"title":"requiring","link":"advanced/requiring.html"},{"title":"plugin-nesting","link":"advanced/plugin-nesting.html"}],"backlink":[{"title":"plugin-nesting","link":"advanced/plugin-nesting.html"},{"title":"matcher","link":"tutorial/matcher.html"}],"localMap":{"nodes":[{"id":"tutorial/create-plugin.md","value":{"title":"create-plugin","path":"tutorial/create-plugin.md","outlink":["tutorial/application.md","advanced/requiring.md","advanced/plugin-nesting.md"],"backlink":["advanced/plugin-nesting.md","tutorial/matcher.md"]}},{"id":"tutorial/application.md","value":{"title":"application","path":"tutorial/application.md","outlink":[],"backlink":[]}},{"id":"advanced/requiring.md","value":{"title":"requiring","path":"advanced/requiring.md","outlink":[],"backlink":[]}},{"id":"advanced/plugin-nesting.md","value":{"title":"plugin-nesting","path":"advanced/plugin-nesting.md","outlink":[],"backlink":[]}},{"id":"tutorial/matcher.md","value":{"title":"matcher","path":"tutorial/matcher.md","outlink":[],"backlink":[]}}],"links":[{"source":"tutorial/create-plugin.md","target":"tutorial/application.md"},{"source":"tutorial/create-plugin.md","target":"advanced/requiring.md"},{"source":"tutorial/create-plugin.md","target":"advanced/plugin-nesting.md"},{"source":"advanced/plugin-nesting.md","target":"tutorial/create-plugin.md"},{"source":"tutorial/matcher.md","target":"tutorial/create-plugin.md"}]}}}');export{b as comp,A as data};
